## ğŸ§  **Sare Shell â€“ Full Project Spec (v1.0)**

> âš™ï¸ Built in Rust â€” no wrapping bash, no shelling out. Sare *is* the shell.

---

### ğŸŒ¸ Project Goals

Sare is a **POSIX-compatible**, feature-complete **Rust shell** with:

* A full **TUI experience** using `ratatui`
* A **real command executor** (not calling zsh/bash)
* Advanced **job control**
* **Multipane** terminal support (like wezterm)
* Extensible internals (for plugins, scripting, future AI integration)
* Adorable UI â€” think *wezterm meets Neovim* with girlcore flair

---

### ğŸ”§ Core Functional Requirements

#### ğŸŒ€ 1. **Command Parsing**

* Parse single commands: `ls`, `mkdir test`, `ping google.com`
* Handle:

  * Flags: `ls -l -a`
  * Quoting: `echo "hello world"`
  * Escapes: `echo hello\ world`
  * Substitution: `echo $(date)` *(optional v2)*

#### â›“ï¸ 2. **Command Execution**

* Use `std::process::Command`
* Don't invoke `/bin/sh` unless required
* Pipe `stdin`, `stdout`, `stderr`
* Display real-time output in TUI

#### ğŸ“‚ 3. **Built-in Commands**

* Must be implemented inside Sare:

  * `cd`
  * `exit`
  * `clear`
  * `history`
  * `pwd`
  * `echo`
  * `help`
  * `jobs`
  * `kill` (job-based)

#### ğŸ§µ 4. **Job Control**

* Foreground/Background tasks:

  * `sleep 5 &`
  * `fg`, `bg`
* Ctrl+C (SIGINT) handling
* Track PID, state, exit code
* Ability to kill or resume jobs

#### ğŸ’» 5. **TUI Interface (ratatui)**

* Command input prompt
* Real-time output pane (scrollable)
* Topbar or footer showing:

  * Current path
  * Job count
  * Time
* Responsive redraw on resize

#### ğŸªŸ 6. **Multipane Support (Advanced)**

* Split vertically/horizontally like wezterm
* Each pane = independent shell
* Hotkeys to:

  * Split (`Ctrl+|`, `Ctrl+-`)
  * Focus (`Ctrl+h/j/k/l`)
  * Close (`Ctrl+w`)
* Panes persist job state

#### ğŸ’¾ 7. **Command History**

* Persistent (saved to `~/.sare_history`)
* Arrow key up/down cycling
* Search (Ctrl+R-style)
* History view in sidebar (optional)

#### ğŸŒ 8. **Autocomplete**

* Tab to autocomplete:

  * Executables from `$PATH`
  * File/directory names
* Suggestion box in TUI
* Fuzzy match (bonus)

#### ğŸ§ª 9. **Testing Suite**

* Unit tests:

  * Command parser
  * Job management
  * Built-in command handlers
* Integration test:

  * Simulate command line interactions
* Benchmark:

  * Measure input latency
  * Execution delay

#### ğŸ”’ 10. **Security & Sandbox**

* Never eval untrusted input
* Restrict internal command execution via `Command::new`
* Future support: jailed subshell?

---

### ğŸ–¼ï¸ UI & Design Goals

#### Sare must feel:

* Responsive
* Predictable
* Personalized (dotfile support, colors)

#### Look:

* Topbar: `sare@machine: ~/projects/sare`
* Prompt: `>>> _`
* Output: Scrollable, resizable
* Theme: Soft pastel + dark mode (wezterm inspired)
* Animations: Optional, framer-motion-like (`ratatui` does not support but simulate with time-based redraws)

---

### ğŸ”„ Internal Architecture

```
+----------------------------+
|        Sare Shell         |
+----------------------------+
|         TUI (ratatui)     |
|    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       |
|    â”‚ Pane Manager â”‚       |
|    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       |
|    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       |
|    â”‚ Command Line â”‚       |
|    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       |
|         /        \        |
|   Parser      Output Log  |
|         \        /        |
|     Executor + JobCtrl    |
|       (Command::new)      |
+----------------------------+
```

---


---

### ğŸ“‚ Folder Layout

```
src/
â”œâ”€â”€ main.rs
â”œâ”€â”€ shell/              # Core shell logic
â”‚   â”œâ”€â”€ parser.rs
â”‚   â”œâ”€â”€ executor.rs
â”‚   â”œâ”€â”€ job.rs
â”‚   â”œâ”€â”€ builtins.rs
â”œâ”€â”€ tui/                # UI rendering
â”‚   â”œâ”€â”€ layout.rs
â”‚   â”œâ”€â”€ prompt.rs
â”‚   â”œâ”€â”€ output.rs
â”‚   â”œâ”€â”€ panes.rs
â”œâ”€â”€ config/
â”‚   â””â”€â”€ settings.rs     # Theme, shortcuts, dotfiles
â”œâ”€â”€ history/
â”‚   â””â”€â”€ manager.rs
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ integration.rs
â”‚   â””â”€â”€ parser_tests.rs
```

---

### ğŸª„ Initial Milestones (v0.1 â†’ v1.0)

| Version | Feature                               |
| ------- | ------------------------------------- |
| v0.1    | Basic REPL loop, command parser       |
| v0.2    | Command execution + TUI display       |
| v0.3    | Built-in commands, `cd`, `exit`, etc. |
| v0.4    | Job control (`&`, `fg`, `bg`, `kill`) |
| v0.5    | Pane split (vertical/horizontal)      |
| v0.6    | Persistent history                    |
| v0.7    | Tab-complete & fuzzy suggestions      |
| v1.0    | Stable, cute, real, portfolio-worthy  |

---
